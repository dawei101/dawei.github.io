---
id: 16
title: samba共享 子目录下不同权限设置。
date: 2012-05-07T14:28:29+00:00
author: dawei
layout: post
guid: http://bookwikiup.com/blog/?p=16
permalink: /2012/05/07/samba%e5%85%b1%e4%ba%ab-%e5%ad%90%e7%9b%ae%e5%bd%95%e4%b8%8b%e4%b8%8d%e5%90%8c%e6%9d%83%e9%99%90%e8%ae%be%e7%bd%ae%e3%80%82/
categories:
  - 未分类
---
在2010年hhdfun工作的时候, 写了一个权限控制的小工具.
  
共享下的 project/ 存放着不同的项目，由于需要，每个项目对某个员工的权限是不同的。
  
工具基于win2003,实现原理是对应目录拒绝某用户服务.
  
这里不得不要吐槽微软, bug非常傻, 如某路径 d:\directory目录某用户无访问权限, 该用户竟然可以通过d:\dir~1\ 等等类似的方法继续访问。

* * *最近

[hhdfun](http://blog.hhdfun.com/ "hhdfun") 宇哥要把共享迁移到linux, 昨天和他一起想服文件共享的解决方案.</p> 

我想到的解决方法是，每个项目新建一个组，每个组加入有此项目权限的用户。但这样操作实在是繁琐。
  
下午我灵光一现，想到了一个绝妙的解决方法。

<div class="wp_syntax">
  <table>
    <tr>
      <td class="code">
        <pre class="" style="font-family:monospace;"><span style="">1</span>、为每一位员工添加用户。比如 user0
<span style="">2</span>、为每个用户添加一个目录比如 /home/samba/user0/，将此用户目录共享 并 设置只有此用户可以访问的权限。<span class="br0">&#40;</span>   chmod -R 0770 /home/samba/user0<span class="br0">&#41;</span>
<span style="">3</span>、建一个项目目录，/project 存放所有项目<span class="br0">&#40;</span>mkdir /project<span class="br0">&#41;</span>。新建项目比如  /project/project0 <span class="br0">&#40;</span>mkdir /prject/project0<span class="br0">&#41;</span> 并设置此目录权限为 <span style="">777</span> <span class="br0">&#40;</span>chmod -R <span style="">777</span> /project/project0<span class="br0">&#41;</span>
<span style="">4</span>、给某用户添加项目权限。将有此项目访问权限的用户  的目录下 做软链 指向此项目。<span class="br0">&#40;</span>ln -s /project/project0 /home/samba/user0/<span class="br0">&#41;</span>
<span style="">5</span>、去掉该用户的此项目权限，只需要  <span class="br0">&#40;</span>rm /home/samba/user0/project0<span class="br0">&#41;</span></pre>
      </td>
    </tr>
  </table>
</div>

至此解决方案结束了，堪称超级完美。